<!doctype html>
<html lang="en" ng-app="todomvc" scroll data-framework="firebase">
<head>
	<meta charset="utf-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- http://stackoverflow.com/questions/1341089/using-meta-tags-to-turn-off-caching-in-all-browsers -->
	<meta http-equiv="cache-control" content="max-age=0" />
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="0" />
	<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
	<meta http-equiv="pragma" content="no-cache" />

	<title>Question Room: {{roomId}}</title>
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/questionroom.css" rel="stylesheet">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
	<!-- need this for comlted ones. TODO: can I do this in bootstrap -->
	<link rel="stylesheet" href="css/main.css">

</head>

<body ng-controller="TodoCtrl" class="body">

	<nav class="navbar navbar-default navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
			  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			  </button>
			  <a class="navbar-brand" href="#">Question Room: {{roomId}}</a>

			</div>

			<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			
				<div ng-show="isSignUpFormShow">
					<form class="navbar-form navbar-header" novalidate role="form">
						
						<label>Tell me who you are: </label> 
						<input type="text" ng-model="userName" placeholder="a nickname is ok" class="input-sm"/>
						
						<input type="submit" ng-click="isSignUpFormShow=signUp()" value="Sign" 
						class="btn btn-default" />
					</form>
				</div>
			  
				<div ng-show="!isSignUpFormShow" class="navbar-header">
				<ul  class="nav navbar-nav navbar-right">
					<li>
						<a  ng-click="isSignUpFormShow=signOut()">Nice to meet you! <strong>{{ userName }}</strong></a>
						</li>
					</ul>
				</div>
			  
				<ul class="nav navbar-nav navbar-right">
					<li>
						<a  href="./index.html">Main</a>
					</li>
					
					<li>
						<button ng-hide="$authData" type="button" class="btn btn-default navbar-btn"  ng-click="FBLogin()">Sign In FB</button>
					</li>
					
					<li>
						<img ng-show="$authData" src="https://graph.facebook.com/{{$authData.facebook.id}}/picture/?type=square&return_ssl_resources=1" alt="{{name}}" />
					{{$authData.facebook.displayName}}
					</li>
					
					<li>
						<button ng-show="$authData" type="button" class="btn btn-default navbar-btn" ng-click="FBLogout()">Logout</button>
					</li>
					
					<li>
						<div class="dropdown" style = "margin:0 10px">
							<button class="btn btn-default navbar-btn dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
								Sorting<span class="caret"></span>
							</button>
							
							<ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
								<li><a href="" ng-click="changeOrder('-timestamp')">Most Recent</a></li>
								<li><a href="" ng-click="changeOrder('-views')">Most Reply</a></li>
								<li><a href="" ng-click="changeOrder('-echo')">Most Like</a></li>
								<li><a href="" ng-click="changeOrder('-d_echo')">Most Dislike</a></li>
								<li><a href="" ng-click="changeOrder('-head')">By Topic</a></li>
								<li><a href="" ng-click="changeOrder('')">Default</a></li>
							</ul>
						</div>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<div class="container">

	<div class="inputBox" >
		<textarea type="text" id="new-todo" class="form-control "
		placeholder="Search or Post Question"
		ng-model="input.wholeMsg" style="height:100px" autofocus></textarea>
		<div class="inputClear">
			<button ng-show="input.wholeMsg" class="btnClear btn-no-outline glyphicon glyphicon-remove" ng-click="clearMsg()"></button>
		</div>
		<div class="inputAsk">
			<button class="btnAsk btn-no-outline glyphicon glyphicon-send" ng-click="addTodo()"> Ask</button>
		</div>
	</div><!-- /input-group -->

<br><br>


	<div class="list-group" id="todo-list">
		<div
			class="list-group-item"
			style="margin:10px 0; padding:0"
			ng-init="isCommentShow=false; isViewShow=false;"
			ng-repeat="todo in todos | filter:input | questionFilter:maxQuestion | orderBy:predicate"
			ng-class="{completed: todo.completed, editing: todo == editedTodo}"
			ng-style="{'background-color' : todo.bgColor , 'border' : thisIsMine(todo.op)}"
			>
			<div class="questionBlock">
				<div class="questionContent">
					<h4 class="list-group-item-heading" ng-switch on="todo.headLastChar" ng-style="{'color' : todo.textColor }">
						
						<span ng-switch-when="?" class="glyphicon glyphicon-question-sign"></span>
						<span ng-switch-when="!" class="glyphicon glyphicon-ice-lolly"></span>
						<span ng-class="{completed: todo.completed}"><strong>{{todo.head}}</strong></span>
						
						<!-- never to show, just need its variable for sorting-->
						<span ng-show="false">{{todo.timestamp}}</span>
						
						<small class="stringTime">{{todo.dateString}} by 
						<span ng-click="tagToMsg(todo.op)" style="text-decoration:underline">{{todo.op}}</span></small>
					</h4>

						<p ng-show="todo.linkedDesc" ng-bind-html="todo.linkedDesc | unsafe" style="padding-left:10px"></p>
					
						<span ng-show="todo.tags" ng-repeat="tag in todo.tags">
						<button class="badge" style="background-color:#40BEB5;padding:3px 7px;margin:0 3px; border:0" ng-click="tagToMsg(tag)">{{tag}}</button>
						</span>
				</div>
				<div style="margin:0 0 5px 5px">
					<br>
					<button 
						type="button" 
						class="btn btn-link btnNav"
						ng-click="addEcho(todo)">
						<i ng-show="showLike(todo.$id)" class="fa fa-thumbs-o-up"> {{todo.echo}}</i>
						<i ng-hide="showLike(todo.$id)" class="fa fa-thumbs-up"> {{todo.echo}}</i>
					</button>
					<button 
						type="button" 
						class="btn btn-link btnNav" 
						ng-click="minusEcho(todo)">
						<i ng-show="showDislike(todo.$id)" class="fa fa-thumbs-o-down"> {{todo.d_echo}}</i>
						<i ng-hide="showDislike(todo.$id)" class="fa fa-thumbs-down"> {{todo.d_echo}}</i>
					</button>
					<button 
						type="button" 
						class="btn btn-link btnNav" 
						ng-click="isViewShow=!isViewShow">
						<i ng-show="todo.views" class="fa fa-commenting-o"> {{todo.views}}</i>
						<i ng-hide="todo.views" class="fa fa-comment-o"> {{todo.views}}</i>
					</button>
					<button 
						type="button" 
						class="btn btn-link btnNav-long" 
						ng-click="isCommentShow=!isCommentShow" 
						ng-show="!isSignUpFormShow">
						<i class="fa fa-pencil-square-o"> Comment</i>
						</button>
					<button 
						ng-show="isAdmin" 
						class="btn btn-link" 
						ng-click="toggleCompleted(todo)">
						<i ng-show="todo.completed" class="fa fa-check-square-o"> Done</i>
						<i ng-hide="todo.completed" class="fa fa-square-o"> Done</i>
						</button>
					<button 
						ng-show="isAdmin" 
						class="btn btn-link" 
						aria-hidden="true" 
						ng-click="removeTodo(todo)">
						<i class="fa fa-trash-o"> Del</i>
						</button>
				</div>
					<div ng-show="isCommentShow" ng-init="form=forms[$index]">
						<form novalidate role="form">

							<textarea type="text" ng-model="form.msg" placeholder="Comment" class="form-control input-sm" rows="3"></textarea>

							<input type="submit" ng-click="isCommentShow = addComment(form, todo); isViewShow = !isCommentShow;" class="btn btn-info " value="submit" />

						</form>
					</div>

			</div>
			<div ng-show="isViewShow">
				<div ng-show="todo.comments">
					<hr>
					<div class="container" style="padding:0 20px" ng-repeat="comment in todo.comments" >
						<p>{{ comment.name }}: {{ comment.msg }} <small style="padding-left:10px">{{ comment.dateString }}</small></p>
						
					</div>
				</div>
			</div>


		</div>	
	</div>



	
</div>
	<!--

	<div id="toTop" class="btn btn-info"><span class="fa fa-arrow-up">Back to Top</span></div>

	<button ng-hide="totalCount<=maxQuestion"
	class="pull-right btn btn-default glyphicon glyphicon-arrow-down"
	type="button" ng-click="increaseMax()"> Show more</button>
-->



<!-- Autolink from https://github.com/gregjacobs/Autolinker.js> -->
<script src="js/lib/Autolinker.min.js"></script>
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
	
<!-- 2.2.2 -->
<script src="js/lib/firebase.js"></script>
<script src="js/lib/angular.min.js"></script>
<script src="js/lib/angularfire.js"></script>

<!-- Ng storage 0.3.6  -->
<script src="js/lib/ngStorage.min.js"></script>

<script src="js/app.js"></script>
<script src="js/filters/questionFilter.js"></script>
<script src="js/controllers/todoCtrl.js"></script>
<script src="js/directives/todoFocus.js"></script>
<script src="js/directives/todoBlur.js"></script>
<script src="js/directives/todoEscape.js"></script>
</body>
</html>
